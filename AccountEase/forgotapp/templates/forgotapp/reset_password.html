{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Reset Password | AccountEase</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Auth CSS -->
    <link href="{% static 'css/auth.css' %}" rel="stylesheet">
</head>

<body class="min-h-screen flex flex-col justify-center px-6">

<div class="max-w-md w-full mx-auto">

    <!-- Icon -->
    <div class="flex justify-center mb-6 fade-up delay-1">
        <div class="h-20 w-20 flex items-center justify-center rounded-full bg-purple-100">
            <i class="fa-solid fa-lock text-3xl text-purple-700"></i>
        </div>
    </div>

    <!-- Heading -->
    <div class="text-center mb-8 fade-up delay-2">
        <h1 class="text-3xl font-extrabold text-[#4e2780] mb-3">Reset Password</h1>
        <p class="text-gray-500">Choose a strong new password</p>
    </div>

    <!-- Django Messages -->
    {% if messages %}
        {% for message in messages %}
            <div class="mb-4 text-center text-red-600 font-semibold fade-up delay-3">
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}

    <!-- FORM ERRORS -->
    {% if form.errors %}
        <div class="mb-5 bg-red-50 border border-red-200 rounded-xl p-4 text-sm text-red-700 fade-up delay-3">
            {% for field in form %}
                {% for error in field.errors %}
                    <p>• {{ error }}</p>
                {% endfor %}
            {% endfor %}
            {% for error in form.non_field_errors %}
                <p>• {{ error }}</p>
            {% endfor %}
        </div>
    {% endif %}

    <!-- FORM -->
    <form method="post" onsubmit="lockButton('resetBtn', 'Resetting...')" class="space-y-6 fade-up delay-3">
        {% csrf_token %}

        <!-- New Password -->
        <div class="relative">
            <i class="fa-solid fa-lock absolute left-4 top-1/2 -translate-y-1/2 text-purple-700"></i>
            <input type="password"
                   name="password"
                   class="input"
                   placeholder="New Password"
                   required
                   id="newPassword">
            <button type="button"
                    onclick="togglePassword('newPassword','eye1')"
                    class="absolute right-4 top-1/2 -translate-y-1/2 text-purple-700">
                <i id="eye1" class="fa-regular fa-eye-slash"></i>
            </button>
        </div>

        <!-- Confirm Password -->
        <div class="relative">
            <i class="fa-solid fa-lock absolute left-4 top-1/2 -translate-y-1/2 text-purple-700"></i>
            <input type="password"
                   name="confirm_password"
                   class="input"
                   placeholder="Confirm Password"
                   required
                   id="confirmPassword">
            <button type="button"
                    onclick="togglePassword('confirmPassword','eye2')"
                    class="absolute right-4 top-1/2 -translate-y-1/2 text-purple-700">
                <i id="eye2" class="fa-regular fa-eye-slash"></i>
            </button>
        </div>

        <!-- Password Rules -->
        <div class="text-sm text-gray-500 bg-gray-50 border rounded-xl p-4">
            <p class="font-semibold text-[#4e2780] mb-1">Password must contain:</p>
            <ul class="list-disc ml-5 space-y-1">
                <li>At least 8 characters</li>
                <li>Not similar to your personal info</li>
                <li>Not a common or numeric password</li>
            </ul>
        </div>

        <button id="resetBtn" type="submit" class="btn-primary">
            Reset Password
        </button>

        <div id="loading" class="hidden text-center font-semibold text-gray-500">
            Resetting…
        </div>
    </form>

    <div class="text-center mt-6 fade-up delay-4">
        <a href="{% url 'login' %}" class="text-sm font-semibold text-[#4e2780] hover:underline">
            ← Back to Login
        </a>
    </div>
</div>

<footer class="mb-6 text-gray-400 text-sm text-center fade-up delay-4">
    Accounting Solution by <strong>INFIVITY</strong>
</footer>

<script src="{% static 'js/auth.js' %}"></script>

</body>
</html>
